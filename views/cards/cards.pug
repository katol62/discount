extends ../layout

block content

    div.container
        div.row
            div.col-lg-4.col-lg-offset-4.col-md-6.col-md-offset-3.col-sm-12
                h2 Cards
            if items
                div.col-lg-12.margin-top

                    div.table-responsive

                        table.table.table-bordered
                            thead
                                tr: th Id
                                    th QR Code
                                    th NFS Code
                                    th M Code
                                    th Card Number
                                    th Transh Number
                            tbody
                                each item, i in items
                                    tr
                                        td #{item.cid}
                                        td #{item.qr_code}
                                        td #{item.nfs_code}
                                        td #{item.m_code}
                                        td #{item.card_nb}
                                        td #{item.transh}


                script(type='text/javascript').
                    function doConfirmDelete(id, name, oid) {
                        bootbox.confirm({
                            message: "Delete tariff \""+name+"\"?",
                            buttons: {
                                confirm: {
                                    label: 'Yes',
                                    className: 'btn-success'
                                },
                                cancel: {
                                    label: 'No',
                                    className: 'btn-danger'
                                }
                            },
                            callback: function (result) {
                                if (result) {
                                    var xhr = new XMLHttpRequest();
                                    var url = '/organizations/'+oid+'/tariffs/'+id+'/delete';
                                    xhr.open('DELETE', url, true);
                                    xhr.setRequestHeader('X-HTTP-Method-Override', 'DELETE');
                                    xhr.onreadystatechange = function () {
                                        if (xhr.readyState == XMLHttpRequest.DONE) {
                                            location.reload();
                                        }
                                    }
                                    xhr.send();
                                }
                            }
                        });
                    }

            if message
                div.col-lg-4.col-lg-offset-4.col-md-6.col-md-offset-3.col-sm-12.margin-top
                    span.mess.success #{message}

            if error
                div.col-lg-4.col-lg-offset-4.col-md-6.col-md-offset-3.col-sm-12.margin-top
                    span.mess.error #{error}

            if errors
                div.col-lg-4.col-lg-offset-4.col-md-6.col-md-offset-3.col-sm-12.margin-top
                    ul.error
                        for error in errors
                            li.mess.error!= error.msg
